import type { GenericMessage } from '../types/message-types.js';
import type { MessageStore } from '../types/message-store.js';
import type { PermissionsGrantMessage } from '../types/permissions-types.js';
import { Message } from './message.js';
export declare class GrantAuthorization {
    /**
     * Performs PermissionsGrant-based authorization against the given message
     * Does not validate grant `conditions` or `scope` beyond `interface` and `method`
     * @throws {Error} if authorization fails
     */
    static authorizeGenericMessage(tenant: string, incomingMessage: Message<GenericMessage>, author: string, messageStore: MessageStore): Promise<void>;
    /**
     * Fetches PermissionsGrantMessage with CID `permissionsGrantId`, and validates that message author may use the grant
     * for this tenant.
     * @returns the PermissionsGrantMessage with CID `permissionsGrantId` if message exists
     * @throws {Error} if PermissionsGrantMessage with CID `permissionsGrantId` does not exist
     */
    private static fetchGrant;
    /**
     * Verify that the incoming message is within the allowed time frame of the grant,
     * and the grant has not been revoked.
     * @throws {Error} if incomingMessage has timestamp for a time in which the grant is not active.
     */
    static verifyGrantActive(tenant: string, incomingMessage: GenericMessage, permissionsGrantMessage: PermissionsGrantMessage, permissionsGrantId: string, messageStore: MessageStore): Promise<void>;
    /**
     * Verify that the `interface` and `method` grant scopes match the incoming message
     * @throws {Error} if the `interface` and `method` of the incoming message do not match the scope of the PermissionsGrant
     */
    private static verifyGrantScopeInterfaceAndMethod;
}
//# sourceMappingURL=grant-authorization.d.ts.map