import type { Web5Agent } from '@web5/agent';
import type { Readable } from '@web5/common';
import type { RecordsWriteMessage, RecordsWriteDescriptor } from '@tbd54566975/dwn-sdk-js';
import { DwnInterfaceName, DwnMethodName } from '@tbd54566975/dwn-sdk-js';
import type { ResponseStatus } from './dwn-api.js';
/**
 * Options that are passed to Record constructor.
 *
 * @beta
 */
export type RecordOptions = RecordsWriteMessage & {
    author: string;
    target: string;
    encodedData?: string | Blob;
    data?: Readable | ReadableStream;
    remoteTarget?: string;
};
/**
 * Represents the record data model, without the auxiliary properties such as
 * the `descriptor` and the `authorization`
 *
 * @beta
 */
export type RecordModel = RecordsWriteDescriptor & Omit<RecordsWriteMessage, 'descriptor' | 'recordId' | 'authorization'> & {
    author: string;
    recordId?: string;
    target: string;
};
/**
 * Options that are passed to update the record on the DWN
 *
 * @beta
 */
export type RecordUpdateOptions = {
    data?: unknown;
    dataCid?: RecordsWriteDescriptor['dataCid'];
    dataSize?: RecordsWriteDescriptor['dataSize'];
    dateModified?: RecordsWriteDescriptor['messageTimestamp'];
    datePublished?: RecordsWriteDescriptor['datePublished'];
    published?: RecordsWriteDescriptor['published'];
};
/**
 * Record wrapper class with convenience methods to send and update,
 * aside from manipulating and reading the record data.
 *
 * Note: The `messageTimestamp` of the most recent RecordsWrite message is
 *       logically equivalent to the date/time at which a Record was most
 *       recently modified.  Since this Record class implementation is
 *       intended to simplify the developer experience of working with
 *       logical records (and not individual DWN messages) the
 *       `messageTimestamp` is mapped to `dateModified`.
 *
 * @beta
 */
export declare class Record implements RecordModel {
    /** Record's author DID */
    author: string;
    /** Record's target DID */
    target: string;
    private _agent;
    private _attestation?;
    private _contextId?;
    private _descriptor;
    private _encodedData?;
    private _encryption?;
    private _readableStream?;
    private _recordId;
    private _remoteTarget?;
    /** Record's signatures attestation */
    get attestation(): RecordsWriteMessage['attestation'];
    /** Record's context ID */
    get contextId(): string;
    /** Record's data format */
    get dataFormat(): string;
    /** Record's creation date */
    get dateCreated(): string;
    /** Record's encryption */
    get encryption(): RecordsWriteMessage['encryption'];
    /** Record's ID */
    get id(): string;
    /** Interface is always `Records` */
    get interface(): DwnInterfaceName.Records;
    /** Method is always `Write` */
    get method(): DwnMethodName.Write;
    /** Record's parent ID */
    get parentId(): string;
    /** Record's protocol */
    get protocol(): string;
    /** Record's protocol path */
    get protocolPath(): string;
    /** Record's recipient */
    get recipient(): string;
    /** Record's schema */
    get schema(): string;
    /** Record's CID */
    get dataCid(): string;
    /** Record's data size */
    get dataSize(): number;
    /** Record's modified date */
    get dateModified(): string;
    /** Record's published date */
    get datePublished(): string;
    /** Record's published status */
    get messageTimestamp(): string;
    /** Record's published status (true/false) */
    get published(): boolean;
    constructor(agent: Web5Agent, options: RecordOptions);
    /**
     * Returns the data of the current record.
     * If the record data is not available, it attempts to fetch the data from the DWN.
     * @returns a data stream with convenience methods such as `blob()`, `json()`, `text()`, and `stream()`, similar to the fetch API response
     * @throws `Error` if the record has already been deleted.
     *
     * @beta
     */
    get data(): {
        /**
         * Returns the data of the current record as a `Blob`.
         *
         * @returns A promise that resolves to a Blob containing the record's data.
         * @throws If the record data is not available or cannot be converted to a `Blob`.
         *
         * @beta
         */
        blob(): Promise<Blob>;
        /**
         * Returns the data of the current record as a `Uint8Array`.
         *
         * @returns A Promise that resolves to a `Uint8Array` containing the record's data bytes.
         * @throws If the record data is not available or cannot be converted to a byte array.
         *
         * @beta
         */
        bytes(): Promise<Uint8Array>;
        /**
         * Parses the data of the current record as JSON and returns it as a JavaScript object.
         *
         * @returns A Promise that resolves to a JavaScript object parsed from the record's JSON data.
         * @throws If the record data is not available, not in JSON format, or cannot be parsed.
         *
         * @beta
         */
        json(): Promise<any>;
        /**
         * Returns the data of the current record as a `string`.
         *
         * @returns A promise that resolves to a `string` containing the record's text data.
         * @throws If the record data is not available or cannot be converted to text.
         *
         * @beta
         */
        text(): Promise<string>;
        /**
         * Provides a `Readable` stream containing the record's data.
         *
         * @returns A promise that resolves to a Node.js `Readable` stream of the record's data.
         * @throws If the record data is not available in-memory and cannot be fetched.
         *
         * @beta
         */
        stream(): Promise<Readable>;
        then(...callbacks: any[]): any;
        catch(callback: any): any;
    };
    /**
     * Send the current record to a remote DWN by specifying their DID
     * (vs waiting for the regular DWN sync)
     * @param target - the DID to send the record to
     * @returns the status of the send record request
     * @throws `Error` if the record has already been deleted.
     *
     * @beta
     */
    send(target: string): Promise<ResponseStatus>;
    /**
     * Returns a JSON representation of the Record instance.
     * It's called by `JSON.stringify(...)` automatically.
     */
    toJSON(): RecordModel;
    /**
     * Convenience method to return the string representation of the Record instance.
     * Called automatically in string concatenation, String() type conversion, and template literals.
     */
    toString(): string;
    /**
     * Update the current record on the DWN.
     * @param options - options to update the record, including the new data
     * @returns the status of the update request
     * @throws `Error` if the record has already been deleted.
     *
     * @beta
     */
    update(options?: RecordUpdateOptions): Promise<ResponseStatus>;
    /**
     * Fetches the record's data from the source DWN.
     *
     * This private method is called when the record data is not available in-memory
     * and needs to be fetched from either a local or a remote DWN.
     * It makes a read request to the specified DWN and processes the response to provide
     * a Node.js `Readable` stream of the record's data.
     *
     * @param target - The DID of the DWN to fetch the data from.
     * @param isRemote - Indicates whether the target DWN is a remote node.
     * @returns A Promise that resolves to a Node.js `Readable` stream of the record's data.
     * @throws If there is an error while fetching or processing the data from the DWN.
     *
     * @beta
     */
    private readRecordData;
    /**
     * Verifies if the properties to be mutated are mutable.
     *
     * This private method is used to ensure that only mutable properties of the `Record` instance
     * are being changed. It checks whether the properties specified for mutation are among the
     * set of properties that are allowed to be modified. If any of the properties to be mutated
     * are not in the set of mutable properties, the method throws an error.
     *
     * @param propertiesToMutate - An iterable of property names that are intended to be mutated.
     * @param mutableDescriptorProperties - A set of property names that are allowed to be mutated.
     *
     * @throws If any of the properties in `propertiesToMutate` are not in `mutableDescriptorProperties`.
     *
     * @beta
     */
    private static verifyPermittedMutation;
}
//# sourceMappingURL=record.d.ts.map